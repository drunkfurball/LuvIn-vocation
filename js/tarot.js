let tarotDeck = {
    layout: [],
    cards: [
        {
            name: "Ace of Swords",
            src: ["img/tarot/ace_of_swords.png", "img/tarot/ace_of_swords_r.png", "img/tarot/ace_of_swords_i.png", "img/tarot/ace_of_swords_i_r.png"]
        },
        {
            name: "Two of Swords",
            src: ["img/tarot/two_of_swords.png", "img/tarot/two_of_swords_r.png", "img/tarot/two_of_swords_i.png", "img/tarot/two_of_swords_i_r.png"]
        },
        {
            name: "Three of Swords",
            src: ["img/tarot/three_of_swords.png", "img/tarot/three_of_swords_r.png", "img/tarot/three_of_swords_i.png", "img/tarot/three_of_swords_i_r.png"]
        },
        {
            name: "Four of Swords",
            src: ["img/tarot/four_of_swords.png", "img/tarot/four_of_swords_r.png", "img/tarot/four_of_swords_i.png", "img/tarot/four_of_swords_i_r.png"]
        },
        {
            name: "Five of Swords",
            src: ["img/tarot/five_of_swords.png", "img/tarot/five_of_swords_r.png", "img/tarot/five_of_swords_i.png", "img/tarot/five_of_swords_i_r.png"]
        },
        {
            name: "Six of Swords",
            src: ["img/tarot/six_of_swords.png", "img/tarot/six_of_swords_r.png", "img/tarot/six_of_swords_i.png", "img/tarot/six_of_swords_i_r.png"]
        },
        {
            name: "Seven of Swords",
            src: ["img/tarot/seven_of_swords.png", "img/tarot/seven_of_swords_r.png", "img/tarot/seven_of_swords_i.png", "img/tarot/seven_of_swords_i_r.png"]
        },
        {
            name: "Eight of Swords",
            src: ["img/tarot/eight_of_swords.png", "img/tarot/eight_of_swords_r.png", "img/tarot/eight_of_swords_i.png", "img/tarot/eight_of_swords_i_r.png"]
        },
        {
            name: "Nine of Swords",
            src: ["img/tarot/nine_of_swords.png", "img/tarot/nine_of_swords_r.png", "img/tarot/nine_of_swords_i.png", "img/tarot/nine_of_swords_i_r.png"]
        },
        {
            name: "Ten of Swords",
            src: ["img/tarot/ten_of_swords.png", "img/tarot/ten_of_swords_r.png", "img/tarot/ten_of_swords_i.png", "img/tarot/ten_of_swords_i_r.png"]
        },
        {
            name: "Page of Swords",
            src: ["img/tarot/page_of_swords.png", "img/tarot/page_of_swords_r.png", "img/tarot/page_of_swords_i.png", "img/tarot/page_of_swords_i_r.png"]
        },
        {
            name: "Knight of Swords",
            src: ["img/tarot/knight_of_swords.png", "img/tarot/knight_of_swords_r.png", "img/tarot/knight_of_swords_i.png", "img/tarot/knight_of_swords_i_r.png"]
        },
        {
            name: "Queen of Swords",
            src: ["img/tarot/queen_of_swords.png", "img/tarot/queen_of_swords_r.png", "img/tarot/queen_of_swords_i.png", "img/tarot/queen_of_swords_i_r.png"]
        },
        {
            name: "King of Swords",
            src: ["img/tarot/king_of_swords.png", "img/tarot/king_of_swords_r.png", "img/tarot/king_of_swords_i.png", "img/tarot/king_of_swords_i_r.png"]
        },
        {
            name: "Ace of Cups",
            src: ["img/tarot/ace_of_cups.png", "img/tarot/ace_of_cups_r.png", "img/tarot/ace_of_cups_i.png", "img/tarot/ace_of_cups_i_r.png"]
        },
        {
            name: "Two of Cups",
            src: ["img/tarot/two_of_cups.png", "img/tarot/two_of_cups_r.png", "img/tarot/two_of_cups_i.png", "img/tarot/two_of_cups_i_r.png"]
        },
        {
            name: "Three of Cups",
            src: ["img/tarot/three_of_cups.png", "img/tarot/three_of_cups_r.png", "img/tarot/three_of_cups_i.png", "img/tarot/three_of_cups_i_r.png"]
        },
        {
            name: "Four of Cups",
            src: ["img/tarot/four_of_cups.png", "img/tarot/four_of_cups_r.png", "img/tarot/four_of_cups_i.png", "img/tarot/four_of_cups_i_r.png"]
        },
        {
            name: "Five of Cups",
            src: ["img/tarot/five_of_cups.png", "img/tarot/five_of_cups_r.png", "img/tarot/five_of_cups_i.png", "img/tarot/five_of_cups_i_r.png"]
        },
        {
            name: "Six of Cups",
            src: ["img/tarot/six_of_cups.png", "img/tarot/six_of_cups_r.png", "img/tarot/six_of_cups_i.png", "img/tarot/six_of_cups_i_r.png"]
        },
        {
            name: "Seven of Cups",
            src: ["img/tarot/seven_of_cups.png", "img/tarot/seven_of_cups_r.png", "img/tarot/seven_of_cups_i.png", "img/tarot/seven_of_cups_i_r.png"]
        },
        {
            name: "Eight of Cups",
            src: ["img/tarot/eight_of_cups.png", "img/tarot/eight_of_cups_r.png", "img/tarot/eight_of_cups_i.png", "img/tarot/eight_of_cups_i_r.png"]
        },
        {
            name: "Nine of Cups",
            src: ["img/tarot/nine_of_cups.png", "img/tarot/nine_of_cups_r.png", "img/tarot/nine_of_cups_i.png", "img/tarot/nine_of_cups_i_r.png"]
        },
        {
            name: "Ten of Cups",
            src: ["img/tarot/ten_of_cups.png", "img/tarot/ten_of_cups_r.png", "img/tarot/ten_of_cups_i.png", "img/tarot/ten_of_cups_i_r.png"]
        },
        {
            name: "Page of Cups",
            src: ["img/tarot/page_of_cups.png", "img/tarot/page_of_cups_r.png", "img/tarot/page_of_cups_i.png", "img/tarot/page_of_cups_i_r.png"]
        },
        {
            name: "Knight of Cups",
            src: ["img/tarot/knight_of_cups.png", "img/tarot/knight_of_cups_r.png", "img/tarot/knight_of_cups_i.png", "img/tarot/knight_of_cups_i_r.png"]
        },
        {
            name: "Queen of Cups",
            src: ["img/tarot/queen_of_cups.png", "img/tarot/queen_of_cups_r.png", "img/tarot/queen_of_cups_i.png", "img/tarot/queen_of_cups_i_r.png"]
        },
        {
            name: "King of Cups",
            src: ["img/tarot/king_of_cups.png", "img/tarot/king_of_cups_r.png", "img/tarot/king_of_cups_i.png", "img/tarot/king_of_cups_i_r.png"]
        },
        {
            name: "Ace of Pentacles",
            src: ["img/tarot/ace_of_pentacles.png", "img/tarot/ace_of_pentacles_r.png", "img/tarot/ace_of_pentacles_i.png", "img/tarot/ace_of_pentacles_i_r.png"]
        },
        {
            name: "Two of Pentacles",
            src: ["img/tarot/two_of_pentacles.png", "img/tarot/two_of_pentacles_r.png", "img/tarot/two_of_pentacles_i.png", "img/tarot/two_of_pentacles_i_r.png"]
        },
        {
            name: "Three of Pentacles",
            src: ["img/tarot/three_of_pentacles.png", "img/tarot/three_of_pentacles_r.png", "img/tarot/three_of_pentacles_i.png", "img/tarot/three_of_pentacles_i_r.png"]
        },
        {
            name: "Four of Pentacles",
            src: ["img/tarot/four_of_pentacles.png", "img/tarot/four_of_pentacles_r.png", "img/tarot/four_of_pentacles_i.png", "img/tarot/four_of_pentacles_i_r.png"]
        },
        {
            name: "Five of Pentacles",
            src: ["img/tarot/five_of_pentacles.png", "img/tarot/five_of_pentacles_r.png", "img/tarot/five_of_pentacles_i.png", "img/tarot/five_of_pentacles_i_r.png"]
        },
        {
            name: "Six of Pentacles",
            src: ["img/tarot/six_of_pentacles.png", "img/tarot/six_of_pentacles_r.png", "img/tarot/six_of_pentacles_i.png", "img/tarot/six_of_pentacles_i_r.png"]
        },
        {
            name: "Seven of Pentacles",
            src: ["img/tarot/seven_of_pentacles.png", "img/tarot/seven_of_pentacles_r.png", "img/tarot/seven_of_pentacles_i.png", "img/tarot/seven_of_pentacles_i_r.png"]
        },
        {
            name: "Eight of Pentacles",
            src: ["img/tarot/eight_of_pentacles.png", "img/tarot/eight_of_pentacles_r.png", "img/tarot/eight_of_pentacles_i.png", "img/tarot/eight_of_pentacles_i_r.png"]
        },
        {
            name: "Nine of Pentacles",
            src: ["img/tarot/nine_of_pentacles.png", "img/tarot/nine_of_pentacles_r.png", "img/tarot/nine_of_pentacles_i.png", "img/tarot/nine_of_pentacles_i_r.png"]
        },
        {
            name: "Ten of Pentacles",
            src: ["img/tarot/ten_of_pentacles.png", "img/tarot/ten_of_pentacles_r.png", "img/tarot/ten_of_pentacles_i.png", "img/tarot/ten_of_pentacles_i_r.png"]
        },
        {
            name: "Page of Pentacles",
            src: ["img/tarot/page_of_pentacles.png", "img/tarot/page_of_pentacles_r.png", "img/tarot/page_of_pentacles_i.png", "img/tarot/page_of_pentacles_i_r.png"]
        },
        {
            name: "Knight of Pentacles",
            src: ["img/tarot/knight_of_pentacles.png", "img/tarot/knight_of_pentacles_r.png", "img/tarot/knight_of_pentacles_i.png", "img/tarot/knight_of_pentacles_i_r.png"]
        },
        {
            name: "Queen of Pentacles",
            src: ["img/tarot/queen_of_pentacles.png", "img/tarot/queen_of_pentacles_r.png", "img/tarot/queen_of_pentacles_i.png", "img/tarot/queen_of_pentacles_i_r.png"]
        },
        {
            name: "King of Pentacles",
            src: ["img/tarot/king_of_pentacles.png", "img/tarot/king_of_pentacles_r.png", "img/tarot/king_of_pentacles_i.png", "img/tarot/king_of_pentacles_i_r.png"]
        },
        {
            name: "Ace of Wands",
            src: ["img/tarot/ace_of_wands.png", "img/tarot/ace_of_wands_r.png", "img/tarot/ace_of_wands_i.png", "img/tarot/ace_of_wands_i_r.png"]
        },
        {
            name: "Two of Wands",
            src: ["img/tarot/two_of_wands.png", "img/tarot/two_of_wands_r.png", "img/tarot/two_of_wands_i.png", "img/tarot/two_of_wands_i_r.png"]
        },
        {
            name: "Three of Wands",
            src: ["img/tarot/three_of_wands.png", "img/tarot/three_of_wands_r.png", "img/tarot/three_of_wands_i.png", "img/tarot/three_of_wands_i_r.png"]
        },
        {
            name: "Four of Wands",
            src: ["img/tarot/four_of_wands.png", "img/tarot/four_of_wands_r.png", "img/tarot/four_of_wands_i.png", "img/tarot/four_of_wands_i_r.png"]
        },
        {
            name: "Five of Wands",
            src: ["img/tarot/five_of_wands.png", "img/tarot/five_of_wands_r.png", "img/tarot/five_of_wands_i.png", "img/tarot/five_of_wands_i_r.png"]
        },
        {
            name: "Six of Wands",
            src: ["img/tarot/six_of_wands.png", "img/tarot/six_of_wands_r.png", "img/tarot/six_of_wands_i.png", "img/tarot/six_of_wands_i_r.png"]
        },
        {
            name: "Seven of Wands",
            src: ["img/tarot/seven_of_wands.png", "img/tarot/seven_of_wands_r.png", "img/tarot/seven_of_wands_i.png", "img/tarot/seven_of_wands_i_r.png"]
        },
        {
            name: "Eight of Wands",
            src: ["img/tarot/eight_of_wands.png", "img/tarot/seven_of_wands_r.png", "img/tarot/seven_of_wands_i.png", "img/tarot/seven_of_wands_i_r.png"]
        },
        {
            name: "Nine of Wands",
            src: ["img/tarot/nine_of_wands.png", "img/tarot/nine_of_wands_r.png", "img/tarot/nine_of_wands_i.png", "img/tarot/nine_of_wands_i_r.png"]
        },
        {
            name: "Ten of Wands",
            src: ["img/tarot/ten_of_wands.png", "img/tarot/ten_of_wands_r.png", "img/tarot/ten_of_wands_i.png", "img/tarot/ten_of_wands_i_r.png"]
        },
        {
            name: "Page of Wands",
            src: ["img/tarot/page_of_wands.png", "img/tarot/page_of_wands_r.png", "img/tarot/page_of_wands_i.png", "img/tarot/page_of_wands_i_r.png"]
        },
        {
            name: "Knight of Wands",
            src: ["img/tarot/knight_of_wands.png", "img/tarot/knight_of_wands_r.png", "img/tarot/knight_of_wands_i.png", "img/tarot/knight_of_wands_i_r.png"]
        },
        {
            name: "Queen of Wands",
            src: ["img/tarot/queen_of_wands.png", "img/tarot/queen_of_wands_r.png", "img/tarot/queen_of_wands_i.png", "img/tarot/queen_of_wands_i_r.png"]
        },
        {
            name: "King of Wands",
            src: ["img/tarot/king_of_wands.png", "img/tarot/king_of_wands_r.png", "img/tarot/king_of_wands_i.png", "img/tarot/king_of_wands_i_r.png"]
        },
        {
            name: "0 – The Fool",
            src: ["img/tarot/0_the_fool.png", "img/tarot/0_the_fool_r.png", "img/tarot/0_the_fool_i.png", "img/tarot/0_the_fool_i_r.png"]
        },
        {
            name: "I – The Magician",
            src: ["img/tarot/I_the_magician.png", "img/tarot/I_the_magician_r.png", "img/tarot/I_the_magician_i.png", "img/tarot/I_the_magician_i_r.png"]
        },
        {
            name: "II – The High Priestess",
            src: ["img/tarot/II_the_high_priestess.png", "img/tarot/II_the_high_priestess_r.png", "img/tarot/II_the_high_priestess_i.png", "img/tarot/II_the_high_priestess_i_r.png"]
        },
        {
            name: "III – The Empress",
            src: ["img/tarot/III_the_empress.png", "img/tarot/III_the_empress_r.png", "img/tarot/III_the_empress_i.png", "img/tarot/III_the_empress_i_r.png"]
        },
        {
            name: "IV – The Emperor",
            src: ["img/tarot/IV_the_emperor.png", "img/tarot/IV_the_emperor_r.png", "img/tarot/IV_the_emperor_i.png", "img/tarot/IV_the_emperor_i_r.png"]
        },
        {
            name: "V – The Hierophant",
            src: ["img/tarot/V_the_hierophant.png", "img/tarot/V_the_hierophant_r.png", "img/tarot/V_the_hierophant_i.png", "img/tarot/V_the_hierophant_i_r.png"]
        },
        {
            name: "VI – The Lovers",
            src: ["img/tarot/VI_the_lovers.png", "img/tarot/VI_the_lovers_r.png", "img/tarot/VI_the_lovers_i.png", "img/tarot/VI_the_lovers_i_r.png"]
        },
        {
            name: "VII – The Chariot",
            src: ["img/tarot/VII_the_chariot.png", "img/tarot/VII_the_chariot_r.png", "img/tarot/VII_the_chariot_i.png", "img/tarot/VII_the_chariot_i_r.png"]
        },
        {
            name: "VIII – Strength",
            src: ["img/tarot/VIII_strength.png", "img/tarot/VIII_strength_r.png", "img/tarot/VIII_strength_i.png", "img/tarot/VIII_strength_i_r.png"]
        },
        {
            name: "IX – The Hermit",
            src: ["img/tarot/IX_the_hermit.png", "img/tarot/IX_the_hermit_r.png", "img/tarot/IX_the_hermit_i.png", "img/tarot/IX_the_hermit_i_r.png"]
        },
        {
            name: "X – Wheel of Fortune",
            src: ["img/tarot/X_wheel_of_fortune.png", "img/tarot/X_wheel_of_fortune_r.png", "img/tarot/X_wheel_of_fortune_i.png", "img/tarot/X_wheel_of_fortune_i_r.png"]
        },
        {
            name: "XI – Justice",
            src: ["img/tarot/XI_justice.png", "img/tarot/XI_justice_r.png", "img/tarot/XI_justice_i.png", "img/tarot/XI_justice_i_r.png"]
        },
        {
            name: "XII – The Hanged Man",
            src: ["img/tarot/XII_the_hanged_man.png", "img/tarot/XII_the_hanged_man_r.png", "img/tarot/XII_the_hanged_man_i.png", "img/tarot/XII_the_hanged_man_i_r.png"]
        },
        {
            name: "XIII – Death",
            src: ["img/tarot/XIII_death.png", "img/tarot/XIII_death_r.png", "img/tarot/XIII_death_i.png", "img/tarot/XIII_death_i_r.png"]
        },
        {
            name: "XIV – Temperance",
            src: ["img/tarot/XIV_temperance.png", "img/tarot/XIV_temperance_r.png", "img/tarot/XIV_temperance_i.png", "img/tarot/XIV_temperance_i_r.png"]
        },
        {
            name: "XV – The Devil",
            src: ["img/tarot/XV_the_devil.png", "img/tarot/XV_the_devil_r.png", "img/tarot/XV_the_devil_i.png", "img/tarot/XV_the_devil_i_r.png"]
        },
        {
            name: "XVI – The Tower",
            src: ["img/tarot/XVI_the_tower.png", "img/tarot/XVI_the_tower_r.png", "img/tarot/XVI_the_tower_i.png", "img/tarot/XVI_the_tower_i_r.png"]
        },
        {
            name: "XVII – The Star",
            src: ["img/tarot/XVII_the_star.png", "img/tarot/XVII_the_star_r.png", "img/tarot/XVII_the_star_i.png", "img/tarot/XVII_the_star_i_r.png"]
        },
        {
            name: "XVIII – The Moon",
            src: ["img/tarot/XVIII_the_moon.png", "img/tarot/XVIII_the_moon_r.png", "img/tarot/XVIII_the_moon_i.png", "img/tarot/XVIII_the_moon_i_r.png"]
        },
        {
            name: "XIX – The Sun",
            src: ["img/tarot/XIX_the_sun.png", "img/tarot/XIX_the_sun_r.png", "img/tarot/XIX_the_sun_i.png", "img/tarot/XIX_the_sun_i_r.png"]
        },
        {
            name: "XX – Judgement",
            src: ["img/tarot/XX_judgement.png", "img/tarot/XX_judgement_r.png", "img/tarot/XX_judgement_i.png", "img/tarot/XX_judgement_i_r.png"]
        },
        {
            name: "XXI – The World",
            src: ["img/tarot/XXI_the_world.png", "img/tarot/XXI_the_world_r.png", "img/tarot/XXI_the_world_i.png", "img/tarot/XXI_the_world_i_r.png"]
        }
    ],
    shuffle: function() {
        for (i = 0; i < this.cards.length; i++) {
            this.cards[i].dealt = false;
        };
    },
    deal: function() {
        num = Math.floor(Math.random() * this.cards.length);
        while (this.cards[num].dealt) {
            num = Math.floor(Math.random() * this.cards.length);
        };
        this.cards[num].dealt = true;
        let card = this.cards[num];
        card.inverted = (Math.random()>0.5?true:false);
        card.rotated = false;
        card.x = 0;
        card.y = 0;
        return card;
    },
    init: function() {
        for (x = 0; x < this.cards.length; x++) {
            this.cards[x].image = [];
            for (s = 0;s < this.cards[x].src.length; s++) {
                this.cards[x].image[s] = new Image();
                this.cards[x].image[s].src = this.cards[x].src[s];
            };
        };
        this.shuffle();
    },
    place: function(e) {
        let msEvt = e;
        let cutter = [];
        function distBetweenPoints(x1, y1, x2, y2) {
            return Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
        }
        if (this.layout.length > 0 && (msEvt.altKey || msEvt.ctrlKey)) {
            for (i = this.layout.length; i > 0; i--)  {
                if (distBetweenPoints(this.layout[i-1].x, this.layout[i-1].y, msEvt.offsetX - 60, msEvt.offsetY - 35) < 45) {
                    cutter.push(i-1);
                }
            }
            if (cutter.length > 0 && msEvt.altKey) {
                for (i=0;i< this.cards.length; i++) {
                    if (this.cards[i].name == this.layout[cutter[0]].name) this.cards[i].dealt = false;
                }
                this.layout.splice(cutter[0], 1);
            }
        }
        if (this.layout.length < this.cards.length && !msEvt.altKey) {
            this.layout.push(this.deal());
            if (msEvt.shiftKey) {
                this.layout[this.layout.length - 1].rotated = true;
            }
            else {
                this.layout[this.layout.length - 1].rotated = false;
            }
            this.layout[this.layout.length - 1].x = msEvt.offsetX - 35;
            this.layout[this.layout.length - 1].y = msEvt.offsetY - 60;
        }
    },
    placeTap: function(e) {
        let tcEvt = e;
        function distBetweenPoints(x1, y1, x2, y2) {
            return Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
        }
        for (i = this.layout.length; i > 0; i--)  {
            if (distBetweenPoints(this.layout[i-1].x, this.layout[i-1].y, msEvt.offsetX - 60, msEvt.offsetY - 35) < 60) {
                cutter.push(i-1);
            }
        }
        if (cutter.length > 0) {    
            for (i=0;i< this.cards.length; i++) {
                if (this.cards[i].name == this.layout[cutter[0]].name) this.cards[i].dealt = false;
            }
            this.layout.splice(cutter[0], 1);
        }
        else {
            if (this.layout.length < this.cards.length) {
                this.layout.push(this.deal());
            }
            if (tcEvt.touches.length > 1) {
                this.layout[this.layout.length - 1].rotated = true;
            }
            else {
                this.layout[this.layout.length - 1].rotated = false;
            }
            this.layout[this.layout.length - 1].x = tcEvt.offsetX - 60;
            this.layout[this.layout.length - 1].y = tcEvt.offsetY - 35;
        }
    },
    drawLayout: function(ctx) {
        for (l=0; l < this.layout.length; l++) {
            this.drawCard(ctx, this.layout[l]);
        }
    },
    drawCard: function(ctx, card) {
        if (card.inverted) {
            if (card.rotated) {
                ctx.drawImage(card.image[3], card.x, card.y);
            }
            else {
                ctx.drawImage(card.image[2], card.x, card.y);
            }
        }
        else if (card.rotated) {
            ctx.drawImage(card.image[1], card.x, card.y);
        }
        else {
            ctx.drawImage(card.image[0], card.x, card.y);
        }
    }
};